{
  "key": "chatbot_lite_readme",
  "origin": "https://github.com/goodsun/chatbotlite",
  "title": "ChatBot Lite — README",
  "date": "",
  "body": "# ChatBot Lite 💬\n\n<p align=\"center\">\n  <img src=\"images/mephi.jpg\" alt=\"Mephi - ChatBot Lite mascot\" width=\"400\">\n</p>\n\n**サーバー不要・$0で動くAIチャットbot。**\n\nHTMLファイルを開くだけ。GitHub Pagesにデプロイするだけ。それで完成。\n\n🔥 **デモ**: https://goodsun.github.io/chatbotlite/\n😈 **メフィ（Devil's Advocate）**: https://teddy.bon-soleil.com/mephi/\n\n## 特徴\n\n- 🚀 **サーバー不要** — 静的ファイル3つ（HTML + CSS + JS）+ CDN依存2つ\n- 🔑 **BYOK** (Bring Your Own Key) — ユーザーのGemini APIキーで動作\n- 💰 **インフラ代$0** — GitHub Pages / ローカルファイル / 任意の静的ホスティング\n- 🎭 **カスタマイズ自在** — `soul/` ディレクトリでキャラ・知識・テーマを自由に設定\n- 📱 **レスポンシブ** — PC/スマホ対応\n- 🔒 **プライバシー** — APIキーはブラウザからGemini APIに直接送信（サーバー不経由）\n- 🛡️ **セキュリティ** — CSP、DOMPurify (SRI)、`x-goog-api-key`ヘッダー\n\n## ファイル構成\n\n```\nindex.html    ← HTML構造（75行）\nstyle.css     ← スタイル\napp.js        ← アプリケーションロジック（ESモジュール）\nsoul/         ← キャラカスタマイズ（オプション）\n```\n\nCDN依存:\n- [DOMPurify](https://github.com/cure53/DOMPurify) — XSSサニタイズ（SRI付き）\n- [marked.js](https://github.com/markedjs/marked) — Markdownレンダリング（SRI付き）\n\n## 使い方\n\n1. `index.html` をブラウザで開く（またはGitHub Pagesにデプロイ）\n2. [Google AI Studio](https://aistudio.google.com/apikey) でGemini APIキーを取得\n3. ヘッダーにAPIキーを入力（入力時に自動検証されます）\n4. 話しかける\n\n## カスタマイズ\n\n⚙️ Settings から：\n\n- **System Prompt**: チャットbotの性格・知識・ルールを定義\n- **Model**: Gemini モデルを選択\n- **Title**: チャットbot名を変更\n\n### Soul ディレクトリ（推奨）\n\n`soul/` ディレクトリにファイルを置くと、起動時に自動読み込みされます。\n読み込みに失敗した場合はチャットエリアにエラー通知が表示されます。\n\n```\nsoul/\n  persona.txt     ← システムプロンプト（キャラ設定）\n  knowledge.txt   ← 追加知識（プロンプトに追記される）\n  config.json     ← タイトル、モデル、アイコン等\n  style.css       ← テーマカスタマイズ（<link>で読み込み）\n  memory.txt      ← 初期記憶のシード（「前世の記憶」）\n```\n\n**config.json の例:**\n```json\n{\n  \"title\": \"メフィ\",\n  \"icon\": \"😈\",\n  \"model\": \"gemini-2.5-flash\",\n  \"avatar\": \"images/mephi.jpg\",\n  \"welcome\": \"…何よ、ジロジロ見て。\",\n  \"subtitle\": \"⚙️ Settings で性格変えられるけど、やったら怒るからね？\",\n  \"botIcon\": \"images/mephi_icon.png\",\n  \"bustup\": \"images/mephi_bustup.png\"\n}\n```\n\n> ⚠️ `welcome` と `subtitle` はDOMPurifyでサニタイズされます。使用可能なタグ: `p`, `br`, `strong`, `em`, `a`, `span` 等。`style`属性は除去されます。スタイル調整には `soul/style.css` を使用してください。\n\n**複数キャラ運用（GitHub Pages推奨）:**\n\nキャラごとにリポジトリを作り、GitHub Pagesで公開するのが最もシンプルで安全です。\n\n```\nmy-mephi/          ← リポジトリ → https://you.github.io/my-mephi/\n  index.html\n  style.css\n  app.js\n  soul/config.json  ← メフィ用設定\n  soul/persona.txt  ← メフィ用ペルソナ\n\nmy-sensei/          ← リポジトリ → https://you.github.io/my-sensei/\n  index.html\n  style.css\n  app.js\n  soul/config.json  ← 先生用設定\n  soul/persona.txt  ← 先生用ペルソナ\n```\n\nリポジトリごとにsoul/とアプリファイルの管理者が一致するため、信頼境界が明確になります。\n\n> 📝 同一オリジン（`you.github.io`）上の複数キャラはlocalStorageが衝突するため、各キーにパスプレフィックスが自動付与されます（例: `cbl_/my-mephi/_history`）。\n\n### 例: 専門知識bot\n\n```\nあなたは料理の専門家です。和食・洋食・中華なんでも詳しく、\nレシピや調理のコツを丁寧に教えてください。\n```\n\n### 例: キャラクターbot\n\n```\nあなたは「にゃんこ先生」です。猫のように気まぐれで、\n語尾に「にゃ」をつけて話します。でも実はとても博識です。\n```\n\n### 例: ドキュメントQ&A\n\nSystem Promptにドキュメント全文を貼り付ければ、\nそのドキュメントについて質問できるQ&Abotになります。\n\n## 技術\n\n- Gemini API (`generateContent`) をブラウザから直接呼び出し\n- 会話履歴をメモリ保持（マルチターン対応）\n- [marked.js](https://github.com/markedjs/marked) によるMarkdownレンダリング（CDN障害時はプレーンテキストにフォールバック）\n- [DOMPurify](https://github.com/cure53/DOMPurify) によるXSSサニタイズ（CDN障害時はHTMLタグ全除去にフォールバック）\n- localStorage でAPIキー・設定を保存（オプトイン）\n- APIキー入力時の自動バリデーション（`models.list` エンドポイントで検証）\n\n## 注意事項\n\n- Gemini API無料枠にはレート制限があります（gemini-2.5-flash: 20回/分）\n- 制限に達すると数秒〜数十秒の待機が必要です\n- 詳細: [Gemini API Rate Limits](https://ai.google.dev/gemini-api/docs/rate-limits)\n\n## セキュリティ\n\n- APIキーはブラウザからGemini APIに直接送信されます（サーバーを経由しません）\n- APIキーは `x-goog-api-key` ヘッダーで送信（URLに露出しません）\n- CSP: `script-src 'self'`（`unsafe-inline` なし）、`style-src 'self'`（`unsafe-inline` なし）\n- キーが漏洩した場合は [Google AI Studio](https://aistudio.google.com/apikey) で即座に再生成できます\n- bot応答は [DOMPurify](https://github.com/cure53/DOMPurify) でサニタイズ済み（SRIハッシュで改竄検知）\n- 外部リンクには `rel=\"noopener noreferrer\"` を自動付与\n\n### APIキーの保存について\n\n「Remember」チェック時、APIキーは **localStorage** に保存されます（sessionStorageではなく）。\n\n**なぜlocalStorageか:**\n- ChatBot Liteは「ファイルを開くだけで動く」が設計思想。タブを閉じるたびにAPIキー再入力では実用に耐えない\n- sessionStorageはタブ単位で消えるため、ブックマークして日常的に使うチャットbotには不向き\n- localStorage保存はオプトイン（デフォルトOFF + セキュリティモーダルでリスク告知）\n\n**リスクと対策:**\n- 同一オリジンのJavaScriptからアクセス可能（XSSや悪意ある拡張機能のリスク）\n- 対策: DOMPurifyによるサニタイズ、dangerousなタグ/属性の除去、CSP設定\n- Gemini APIキーは無料で即座に再生成可能（漏洩時の被害は限定的）\n- **機密性の高い用途ではRememberをOFFにして利用してください**\n\n### APIキーのバリデーション\n\nAPIキー入力時に `models.list` エンドポイントへ軽量GETリクエストを送信し、有効性を検証します。\n\n- ✅ 緑ボーダー: キーが有効\n- ❌ 赤ボーダー: キーが無効\n- ⚠️ 黄ボーダー: ネットワークエラー\n\nこの検証はユーザーがAPIキーを入力・変更した時のみ実行されます。\n\n## プロダクション導入時の考慮事項\n\n本プロジェクトはPoCです。実際のサービスに組み込む際は以下を検討してください。\n\n- **HTMLセマンティクス**: `<div>` → `<header>`, `<main>`, `<section>` 等に整理\n- **関数分割**: `loadSoul`, `sendMessage` のリファクタリング\n- **状態管理**: 散在する`let`変数をAppStateオブジェクトに集約\n- **localStorage定数化**: キー名(`cbl_*`)を定数で一元管理\n- **ストリーミング対応**: `generateContent` → `streamGenerateContent` で体感速度向上\n\n## ライセンス\n\nMIT\n\n## Author\n\nMade with 🧸 by [goodsun](https://github.com/goodsun) & Teddy",
  "tags": "ChatBot Lite, README, bon-soleil, product"
}